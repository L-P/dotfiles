export PATH=~/.bin:$PATH
# Scarcely used (see `update-alternatives --config editor`)
export EDITOR=vim

# Nicer less by default
export LESS='-RFXS -x4'
export PAGER='less'
export MANPAGER='less'
export TERM='xterm-256color'

# Color aliases
alias grep='grep --color=auto'
alias tree='tree -C'

# Aliases
alias ls='ls --group-directories-first --color -v'
alias ll='ls -vlh'
alias la='ll -va'
alias mkdir='mkdir -pv'
alias rm='rm --preserve-root'
alias gd='git diff -M -C'
alias gds='git diff -M -C --staged'
alias gs='git status --short'
alias py='python3'
alias ripit='ripit -o /dev/shm/ripit -c 2 -q 8' # FLAC @ max comp.
alias json='json_reformat | pygmentize -l json'
alias cdr='cd $(git rev-parse --show-toplevel)'

# Typos
alias cim='vim'
alias vp='cp'
alias cd..='cd ..'
alias :q='exit'
alias :e='vim'
alias :tabe='vim'

# Nicer du (ncdu is nice too)
function duf() {
    du -csh -- "$@" | sort -rh
}

# Handy grep aliases, since ack sucks.
function g() {
	grep --color=always -EHnr --exclude-dir='.svn' --exclude-dir='.git' $@ . | $PAGER ;
}
function gi() {
	grep --color=always -EHnri --exclude-dir='.svn' --exclude-dir='.git' $@ . | $PAGER ;
}

# Same aliases for the faster git grep.
function gg() {
	git grep --color=always -En $@
}
function ggi() {
	git grep --color=always -Eni $@
}

# Find aliases
function f() {
	find . -iname "*$@*"
}
function ff() {
	find . -type f -iname "*$@*"
}
function fd() {
	find . -type d -iname "*$@*"
}

# Make a git repo with an empty commit
function mkrepo() {
    (
        mkdir $1
        pushd $1
        git init
        git ci --allow-empty -m "Initial commit."
        popd ..
    ) > /dev/null
}

# Record terminal input/output to file.
function record() {
    local date="$(date --rfc-3339=seconds | sed 's/ /_/g')"
    local dir="$HOME/.terminal_recordings"
    mkdir -p "$dir" &> /dev/null
    script -t "$dir/script_$date" 2> "$dir/timing_$date"
}

if [ "root" != "$(whoami)" ]; then
    /usr/bin/keychain $HOME/.ssh/* &> /dev/null
    source $HOME/.keychain/$HOST-sh &> /dev/null
fi
